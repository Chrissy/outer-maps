<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title></title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.18.0/mapbox-gl.js'></script>
    <script src='osmtogeojson.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.18.0/mapbox-gl.css' rel='stylesheet' />
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
        #overlay { position: absolute; z-index: 1; padding: 1em; background: white; border: 2px solid #ddd; display: none; }
        #overlay.visible { display: block; }
    </style>
</head>
<body>

<div id='map'></div>
<div id='overlay'></div>
<script>

mapboxgl.accessToken = 'pk.eyJ1IjoiZml2ZWZvdXJ0aHMiLCJhIjoiY2lvMXM5MG45MWFhenUybTNkYzB1bzJ0MiJ9._5Rx_YN9mGwR8dwEB9D2mg';
var map = new mapboxgl.Map({
    container: 'map', // container id
    style: 'mapbox://styles/mapbox/outdoors-v9', //stylesheet location
    center: [-121.69, 45.37], // starting position
    zoom: 11 // starting zoom
});

map.on('load', function() {

    map.addSource('trails-data', {
      'type': 'geojson',
      'data': "mount_hood.geojson"
    })

    map.addLayer({
      'id': 'trails',
      'source': 'trails-data',
      'type': 'line',
      'paint': {
        'line-color': '#47B05A',
        'line-width': 4
      }
    })

    map.addLayer({
      'id': 'trails-active',
      'source': 'trails-data',
      'type': 'line',
      'paint': {
        'line-color': '#FF9100',
        'line-width': 4
      },
      "filter": ["==", "name", ""]
    })

    // map.on('click', function(event){
    //   var features = map.queryRenderedFeatures(event.point, { layers: ['trails'] });
    //   let overlay = document.getElementById('overlay')
    //
    //   if (features.length) {
    //   } else {
    //   }
    // })

    map.on('mousemove', function (event) {
        var features = map.queryRenderedFeatures(event.point, { layers: ['trails'] });
        if (features.length) {
          map.getCanvas().style.cursor = 'pointer'
          map.setFilter("trails-active", ["==", "name", features[0].properties.name]);
          overlay.innerHTML = `
            name: ${features[0].properties.name}<br/>
            source: ${features[0].properties.source}
            `
          overlay.style.top = `${event.point.y + 5}px`
          overlay.style.left = `${event.point.x + 5}px`
          overlay.classList.add("visible")
        } else {
          map.getCanvas().style.cursor = 'default'
          map.setFilter("trails-active", ["==", "name", ""]);
          overlay.classList.remove("visible")
        }
    });
})
</script>

</body>
</html>
